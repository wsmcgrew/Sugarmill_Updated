version: "3.8"

## DEFINE SERVICES
services:
  ## FRONTEND
  web:
    container_name: WEB
    image: sugarmill/sugar-mill:dev
    build: 
      context: ./sugar-mill/client
      target: Development
    ports:
      - 8080:8080
    expose: 
      - "8080"  
    volumes:
      - ./sugar-mill/client:/app

   ## DATABASE
  database:
    container_name: DB
    image: sugarmill/sugar-mill-db:dev
    build:
      context: ./sugar-mill-DB        
    environment:
      SA_PASSWORD: "MyDatabasePassword123"
      ACCEPT_EULA: "Y"
    expose: 
      - "1433"
    ports:
      - 1433:1433
    volumes: 
      - SQL_Data:/var/opt/mssql/data

  ## BACKEND API
  api:
    container_name: API
    image: sugarmill/sugarmill-api:dev
    build:
      context: ./sugar-mill/server
      target: Development
    ports:
      - "5001:5001"
    environment:
      - DB_HOST=localhost
      - DB_USER=sa
      - DB_PASSWORD=MyDatabasePassword123
      - DB_NAME=Cane_Loads
    volumes:
      - ./sugar-mill/server:/app

## DEFINE VOLUMES
volumes: 
  SQL_Data:
    external: 
      name: SB_SQL_DATA
